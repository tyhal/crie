{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/tyhal/crie/internal/config/language/languages",
  "$ref": "#/$defs/Languages",
  "$defs": {
    "Instance": {
      "properties": {
        "bin": {
          "type": "string",
          "description": "the binary or command to use"
        },
        "start": {
          "$ref": "#/$defs/Par",
          "description": "parameters that will be put in front of the file path"
        },
        "end": {
          "$ref": "#/$defs/Par",
          "description": "parameters that will be put behind the file path"
        },
        "chdir": {
          "type": "boolean",
          "description": "if true the tool will change directory to where the target file is located"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "bin"
      ]
    },
    "Language": {
      "properties": {
        "match": {
          "$ref": "#/$defs/Regex",
          "oneOf": [
            {
              "type": "string"
            },
            {
              "type": "array"
            }
          ],
          "description": "a regex to match files against to know they are the target of this language"
        },
        "fmt": {
          "$ref": "#/$defs/Linter",
          "description": "used for the given language when formatting"
        },
        "chk": {
          "$ref": "#/$defs/Linter",
          "description": "used for the given language when linting/checking"
        }
      },
      "additionalProperties": false,
      "type": "object"
    },
    "Languages": {
      "properties": {
        "languages": {
          "additionalProperties": {
            "$ref": "#/$defs/Language"
          },
          "type": "object",
          "description": "a map of languages that crie should be able to run"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "languages"
      ]
    },
    "LintCli": {
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "cli"
          ],
          "description": "the most common linter type, a cli tool"
        },
        "exec": {
          "$ref": "#/$defs/Instance",
          "description": "settings for the command to run"
        },
        "img": {
          "type": "string",
          "description": "the container image to pull and use"
        },
        "tag_crie_version": {
          "type": "boolean",
          "description": "if an image tag should be appended with cries current version"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "type",
        "exec"
      ]
    },
    "LintNoop": {
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "noop"
          ],
          "description": "a linter type to do nothing"
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "type"
      ]
    },
    "LintShfmt": {
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "shfmt"
          ],
          "description": "a built in shell formatter thanks to mvdan"
        },
        "language": {
          "type": "string",
          "enum": [
            "bash",
            "posix",
            "sh",
            "mksh"
          ]
        }
      },
      "additionalProperties": false,
      "type": "object",
      "required": [
        "type",
        "language"
      ]
    },
    "Linter": {
      "oneOf": [
        {
          "$ref": "#/$defs/LintCli"
        },
        {
          "$ref": "#/$defs/LintShfmt"
        },
        {
          "$ref": "#/$defs/LintNoop"
        }
      ]
    },
    "Par": {
      "items": {
        "type": "string"
      },
      "type": "array"
    },
    "Regex": {
      "properties": {},
      "additionalProperties": false,
      "type": "object"
    }
  }
}
